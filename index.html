<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ù„ØºØ§Ø²</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        body {
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #2c3e50;
            text-align: center;
        }
        .btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            display: block;
            width: 100%;
        }
        .btn:hover {
            background-color: #2980b9;
        }
        .delete-btn {
            background-color: #e74c3c;
        }
        .delete-btn:hover {
            background-color: #c0392b;
        }
        .success-btn {
            background-color: #2ecc71;
        }
        .success-btn:hover {
            background-color: #27ae60;
        }
        #main-menu {
            display: block;
        }
        #username-section, #puzzle-section, #history-section {
            display: none;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .puzzle-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px auto;
            max-width: 300px;
        }
        .puzzle-tile {
            background-color: #3498db;
            color: white;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .puzzle-tile:hover {
            background-color: #2980b9;
        }
        .puzzle-tile.empty {
            background-color: transparent;
            border: 2px dashed #ccc;
            cursor: default;
        }
        #puzzle-feedback {
            text-align: center;
            font-size: 20px;
            margin: 20px 0;
            min-height: 30px;
        }
        .history-item {
            background-color: white;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: relative;
        }
        .history-item .delete-item {
            position: absolute;
            left: 15px;
            top: 15px;
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
        }
        .history-info {
            margin-right: 40px;
        }
        .success {
            color: #2ecc71;
        }
        .failed {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
        <div id="main-menu">
            <h1>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ù„ØºØ§Ø²</h1>
            <button id="start-game" class="btn">Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
            <button id="view-history" class="btn">Ø§Ù„Ø³Ø¬Ù„</button>
        </div>

        <!-- Ù‚Ø³Ù… Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… -->
        <div id="username-section">
            <h2>Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ</h2>
            <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨">
            <button id="start-puzzle" class="btn">Ø¨Ø¯Ø¡ Ø§Ù„Ù„ØºØ²</button>
            <button id="back-to-main-from-name" class="btn">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ø£Ù„ØºØ§Ø² -->
        <div id="puzzle-section">
            <h2 id="puzzle-title">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù„ØºØ²</h2>
            <div id="puzzle-description">ÙˆØµÙ Ø§Ù„Ù„ØºØ²</div>
            <div id="puzzle-content"></div>
            <div id="puzzle-feedback"></div>
            <button id="next-stage" class="btn" style="display: none;">Ø§Ù„ØªØ§Ù„ÙŠ</button>
            <button id="back-to-main-from-game" class="btn">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ø³Ø¬Ù„ -->
        <div id="history-section">
            <h1>Ø³Ø¬Ù„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</h1>
            <button id="clear-all-history" class="btn delete-btn">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</button>
            <div id="history-list"></div>
            <button id="back-to-main-from-history" class="btn">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>
    </div>

    <script>
        // Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ DOM Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
        document.addEventListener('DOMContentLoaded', function() {
            console.log("ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙ†ÙÙŠØ°");
            
            // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ù„ØºØ§Ø²
            const puzzles = [
                {
                    id: 1,
                    title: "Ù„ØºØ² ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…",
                    description: "Ù‚Ù… Ø¨ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ù…Ù† 1 Ø¥Ù„Ù‰ 8 Ù…Ø¹ ØªØ±Ùƒ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø£Ø®ÙŠØ± ÙØ§Ø±ØºÙ‹Ø§",
                    stages: [
                        {
                            initialOrder: [2, 3, 6, 1, 4, 8, 7, 5],
                            solution: [1, 2, 3, 4, 5, 6, 7, 8]
                        },
                        {
                            initialOrder: [3, 1, 2, 4, 5, 6, 8, 7],
                            solution: [1, 2, 3, 4, 5, 6, 7, 8]
                        },
                        {
                            initialOrder: [8, 7, 6, 5, 4, 3, 2, 1],
                            solution: [1, 2, 3, 4, 5, 6, 7, 8]
                        }
                    ]
                },
                {
                    id: 2,
                    title: "Ù„ØºØ² Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø§Ù„Ø¨Ø³ÙŠØ·",
                    description: "Ø­Ù„ Ø§Ù„Ù…Ø³Ø£Ù„Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©",
                    stages: [
                        {
                            question: "5 + 7 = ?",
                            solution: "12"
                        },
                        {
                            question: "9 Ã— 6 = ?",
                            solution: "54"
                        },
                        {
                            question: "15 Ã· 3 + 4 = ?",
                            solution: "9"
                        }
                    ]
                }
            ];

            // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            const state = {
                currentView: 'main-menu',
                currentPuzzle: 0,
                currentStage: 0,
                username: '',
                history: JSON.parse(localStorage.getItem('puzzleHistory')) || []
            };

            // Ø¹Ù†Ø§ØµØ± DOM
            const mainMenu = document.getElementById('main-menu');
            const usernameSection = document.getElementById('username-section');
            const puzzleSection = document.getElementById('puzzle-section');
            const historySection = document.getElementById('history-section');

            // Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ…
            const startGameBtn = document.getElementById('start-game');
            const viewHistoryBtn = document.getElementById('view-history');
            const startPuzzleBtn = document.getElementById('start-puzzle');
            const nextStageBtn = document.getElementById('next-stage');
            const clearHistoryBtn = document.getElementById('clear-all-history');
            const backToMainFromName = document.getElementById('back-to-main-from-name');
            const backToMainFromGame = document.getElementById('back-to-main-from-game');
            const backToMainFromHistory = document.getElementById('back-to-main-from-history');

            // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù„ØºØ²
            const puzzleTitle = document.getElementById('puzzle-title');
            const puzzleDescription = document.getElementById('puzzle-description');
            const puzzleContent = document.getElementById('puzzle-content');
            const puzzleFeedback = document.getElementById('puzzle-feedback');
            const usernameInput = document.getElementById('username');
            const historyList = document.getElementById('history-list');

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            function init() {
                console.log("ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...");
                
                // ØªØ¹ÙŠÙŠÙ† Ù…Ø¹Ø§Ù„Ø¬ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
                startGameBtn.addEventListener('click', function() {
                    console.log("Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©");
                    showView('username-section');
                });
                
                viewHistoryBtn.addEventListener('click', function() {
                    console.log("Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„");
                    showHistory();
                });
                
                startPuzzleBtn.addEventListener('click', function() {
                    console.log("Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø¨Ø¯Ø¡ Ø§Ù„Ù„ØºØ²");
                    startPuzzle();
                });
                
                nextStageBtn.addEventListener('click', function() {
                    console.log("Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„ØªØ§Ù„ÙŠ");
                    nextStage();
                });
                
                clearHistoryBtn.addEventListener('click', function() {
                    console.log("Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„");
                    clearAllHistory();
                });
                
                backToMainFromName.addEventListener('click', function() {
                    console.log("Ø§Ù„Ø¹ÙˆØ¯Ø© Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù…");
                    showView('main-menu');
                });
                
                backToMainFromGame.addEventListener('click', function() {
                    console.log("Ø§Ù„Ø¹ÙˆØ¯Ø© Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø©");
                    showView('main-menu');
                });
                
                backToMainFromHistory.addEventListener('click', function() {
                    console.log("Ø§Ù„Ø¹ÙˆØ¯Ø© Ù…Ù† Ø§Ù„Ø³Ø¬Ù„");
                    showView('main-menu');
                });

                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„ Ù…Ù† localStorage
                loadHistory();
                
                console.log("ØªÙ…Øª Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¨Ù†Ø¬Ø§Ø­");
            }

            // Ø¹Ø±Ø¶ ÙˆØ§Ø¬Ù‡Ø© Ù…Ø¹ÙŠÙ†Ø©
            function showView(viewName) {
                console.log("Ø¹Ø±Ø¶ ÙˆØ§Ø¬Ù‡Ø©: " + viewName);
                state.currentView = viewName;
                
                // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
                mainMenu.style.display = 'none';
                usernameSection.style.display = 'none';
                puzzleSection.style.display = 'none';
                historySection.style.display = 'none';
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
                if (viewName === 'main-menu') {
                    mainMenu.style.display = 'block';
                } else if (viewName === 'username-section') {
                    usernameSection.style.display = 'block';
                } else if (viewName === 'puzzle-section') {
                    puzzleSection.style.display = 'block';
                } else if (viewName === 'history-section') {
                    historySection.style.display = 'block';
                }
            }

            // Ø¨Ø¯Ø¡ Ø§Ù„Ù„ØºØ²
            function startPuzzle() {
                const username = usernameInput.value.trim();
                if (!username) {
                    alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨');
                    return;
                }

                state.username = username;
                state.currentPuzzle = 0;
                state.currentStage = 0;
                showView('puzzle-section');
                loadPuzzle();
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ØºØ² Ø§Ù„Ø­Ø§Ù„ÙŠ
            function loadPuzzle() {
                const puzzle = puzzles[state.currentPuzzle];
                const stage = puzzle.stages[state.currentStage];

                puzzleTitle.textContent = puzzle.title;
                puzzleDescription.textContent = puzzle.description;
                puzzleFeedback.textContent = '';
                nextStageBtn.style.display = 'none';

                // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø³Ø§Ø¨Ù‚
                puzzleContent.innerHTML = '';

                if (puzzle.id === 1) { // Ù„ØºØ² ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
                    renderNumberPuzzle(stage);
                } else if (puzzle.id === 2) { // Ù„ØºØ² Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª
                    renderMathPuzzle(stage);
                }
            }

            // Ø¹Ø±Ø¶ Ù„ØºØ² Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
            function renderNumberPuzzle(stage) {
                const tiles = [...stage.initialOrder, null]; // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„ÙØ§Ø±Øº
                let emptyIndex = tiles.length - 1;

                const grid = document.createElement('div');
                grid.className = 'puzzle-grid';

                tiles.forEach((tile, index) => {
                    const tileElement = document.createElement('div');
                    tileElement.className = tile ? 'puzzle-tile' : 'puzzle-tile empty';
                    tileElement.textContent = tile || '';
                    tileElement.dataset.index = index;

                    if (tile) {
                        tileElement.addEventListener('click', function() {
                            // ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ù…Ø¬Ø§ÙˆØ± ÙØ§Ø±ØºÙ‹Ø§
                            const adjacentIndices = getAdjacentIndices(parseInt(this.dataset.index), emptyIndex);
                            
                            if (adjacentIndices.includes(emptyIndex)) {
                                // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
                                const temp = tiles[index];
                                tiles[index] = tiles[emptyIndex];
                                tiles[emptyIndex] = temp;
                                
                                emptyIndex = index;
                                renderTiles(grid, tiles);
                                
                                // ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø­Ù„ ØµØ­ÙŠØ­Ù‹Ø§
                                checkSolution(tiles.slice(0, -1), stage.solution);
                            }
                        });
                    }

                    grid.appendChild(tileElement);
                });

                puzzleContent.appendChild(grid);

                function renderTiles(container, tiles) {
                    container.innerHTML = '';
                    tiles.forEach((tile, index) => {
                        const tileElement = document.createElement('div');
                        tileElement.className = tile ? 'puzzle-tile' : 'puzzle-tile empty';
                        tileElement.textContent = tile || '';
                        tileElement.dataset.index = index;

                        if (tile) {
                            tileElement.addEventListener('click', function() {
                                const adjacentIndices = getAdjacentIndices(parseInt(this.dataset.index), emptyIndex);
                                
                                if (adjacentIndices.includes(emptyIndex)) {
                                    const temp = tiles[index];
                                    tiles[index] = tiles[emptyIndex];
                                    tiles[emptyIndex] = temp;
                                    
                                    emptyIndex = index;
                                    renderTiles(grid, tiles);
                                    checkSolution(tiles.slice(0, -1), stage.solution);
                                }
                            });
                        }

                        container.appendChild(tileElement);
                    });
                }
            }

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ù…Ø¬Ø§ÙˆØ±Ø©
            function getAdjacentIndices(index, emptyIndex) {
                const row = Math.floor(index / 3);
                const col = index % 3;
                const adjacent = [];

                // Ø£Ø¹Ù„Ù‰
                if (row > 0) adjacent.push(index - 3);
                // Ø£Ø³ÙÙ„
                if (row < 2) adjacent.push(index + 3);
                // ÙŠØ³Ø§Ø±
                if (col > 0) adjacent.push(index - 1);
                // ÙŠÙ…ÙŠÙ†
                if (col < 2) adjacent.push(index + 1);

                return adjacent;
            }

            // Ø¹Ø±Ø¶ Ù„ØºØ² Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª
            function renderMathPuzzle(stage) {
                puzzleDescription.textContent = stage.question;

                const input = document.createElement('input');
                input.type = 'text';
                input.placeholder = 'Ø£Ø¯Ø®Ù„ Ø§Ù„Ø­Ù„';
                input.id = 'math-answer';

                const submitBtn = document.createElement('button');
                submitBtn.className = 'btn success-btn';
                submitBtn.textContent = 'ØªØ­Ù‚Ù‚';
                submitBtn.addEventListener('click', function() {
                    const answer = input.value.trim();
                    if (answer === stage.solution) {
                        puzzleFeedback.textContent = 'âœ… Ø£Ø­Ø³Ù†Øª! Ø§Ù„Ø­Ù„ ØµØ­ÙŠØ­';
                        puzzleFeedback.className = 'success';
                        nextStageBtn.style.display = 'block';
                        saveHistory(true);
                    } else {
                        puzzleFeedback.textContent = 'âŒ Ø§Ù„Ø­Ù„ ØºÙŠØ± ØµØ­ÙŠØ­';
                        puzzleFeedback.className = 'failed';
                        saveHistory(false);
                    }
                });

                puzzleContent.appendChild(input);
                puzzleContent.appendChild(submitBtn);
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ù„
            function checkSolution(current, solution) {
                const isCorrect = current.every((num, index) => num === solution[index]);
                
                if (isCorrect) {
                    puzzleFeedback.textContent = 'âœ… Ø£Ø­Ø³Ù†Øª! Ø§Ù„Ø­Ù„ ØµØ­ÙŠØ­';
                    puzzleFeedback.className = 'success';
                    nextStageBtn.style.display = 'block';
                    saveHistory(true);
                }
            }

            // Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
            function nextStage() {
                const puzzle = puzzles[state.currentPuzzle];
                
                if (state.currentStage < puzzle.stages.length - 1) {
                    state.currentStage++;
                    loadPuzzle();
                } else {
                    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù„ØºØ² Ø§Ù„ØªØ§Ù„ÙŠ
                    if (state.currentPuzzle < puzzles.length - 1) {
                        state.currentPuzzle++;
                        state.currentStage = 0;
                        loadPuzzle();
                    } else {
                        // Ø§Ù†ØªÙ‡Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù„ØºØ§Ø²
                        alert('ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù„ØºØ§Ø²');
                        showView('main-menu');
                    }
                }
            }

            // Ø­ÙØ¸ Ø§Ù„Ø³Ø¬Ù„
            function saveHistory(isSuccess) {
                const record = {
                    username: state.username,
                    puzzleId: puzzles[state.currentPuzzle].id,
                    puzzleTitle: puzzles[state.currentPuzzle].title,
                    stage: state.currentStage + 1,
                    success: isSuccess,
                    date: new Date().toLocaleDateString('ar-EG')
                };

                state.history.push(record);
                localStorage.setItem('puzzleHistory', JSON.stringify(state.history));
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„
            function showHistory() {
                showView('history-section');
                loadHistory();
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„
            function loadHistory() {
                historyList.innerHTML = '';
                
                if (state.history.length === 0) {
                    historyList.innerHTML = '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>';
                    return;
                }

                state.history.forEach((record, index) => {
                    const item = document.createElement('div');
                    item.className = 'history-item';
                    
                    const status = record.success ? 'ØªÙ…' : 'Ù„Ù… ÙŠØªÙ…';
                    const statusClass = record.success ? 'success' : 'failed';
                    
                    item.innerHTML = `
                        <button class="delete-item" data-index="${index}">ğŸ—‘ï¸</button>
                        <div class="history-info">
                            <h3>${record.username}</h3>
                            <p>Ø§Ù„Ù„ØºØ²: ${record.puzzleTitle} (Ø§Ù„Ù…Ø±Ø­Ù„Ø© ${record.stage})</p>
                            <p>Ø§Ù„Ø­Ø§Ù„Ø©: <span class="${statusClass}">${status}</span></p>
                            <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${record.date}</p>
                        </div>
                    `;

                    historyList.appendChild(item);
                });

                // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø°Ù
                document.querySelectorAll('.delete-item').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const index = parseInt(this.dataset.index);
                        deleteHistoryItem(index);
                    });
                });
            }

            // Ø­Ø°Ù Ø¹Ù†ØµØ± Ù…Ù† Ø§Ù„Ø³Ø¬Ù„
            function deleteHistoryItem(index) {
                state.history.splice(index, 1);
                localStorage.setItem('puzzleHistory', JSON.stringify(state.history));
                loadHistory();
            }

            // Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
            function clearAllHistory() {
                if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ØŸ')) {
                    state.history = [];
                    localStorage.removeItem('puzzleHistory');
                    loadHistory();
                }
            }

            // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            init();
        });
    </script>
</body>
</html>